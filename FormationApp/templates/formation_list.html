{% extends "base.html" %}
{% block title %}Formations & Chapitres{% endblock %}

{% block content %}
<div class="py-4">
	<div class="d-flex justify-content-between align-items-center mb-3">
		<h1 class="h4 mb-0">Formations</h1>
		<span class="badge badge-secondary">Total {{ formations|length }}</span>
	</div>

	{% if formations %}
		<div class="row">
			{% for formation in formations %}
				<div class="col-md-6 col-lg-4 mb-4">
					<div class="card h-100 shadow-sm">
						<div class="card-body d-flex flex-column">
							<div class="mb-3">
								<h5 class="card-title mb-1">{{ formation.titre }}</h5>
								<p class="text-muted small mb-2">{{ formation.domaine }} &middot; {{ formation.niveau }}</p>
								<p class="card-text">{{ formation.description|truncatewords:30 }}</p>
							</div>

							<div class="mt-auto">
								<div class="d-flex justify-content-between align-items-center mb-2">
									<span class="font-weight-bold small">Chapitres</span>
									<span class="badge badge-light">{{ formation.chapitres.all|length }}</span>
								</div>
								{% if formation.chapitres.all %}
									<ul class="list-group list-group-flush">
										{% for chapitre in formation.chapitres.all %}
											<li class="list-group-item px-0">
												<div class="d-flex justify-content-between align-items-start">
													<div>
														<div class="d-flex align-items-center mb-1">
															<span class="badge badge-primary mr-2">{{ chapitre.ordre }}</span>
															<span class="font-weight-bold">{{ chapitre.titre }}</span>
														</div>
														<p class="mb-0 text-muted small">{{ chapitre.contenu_texte|truncatewords:18 }}</p>
													</div>
												</div>
											</li>
										{% endfor %}
									</ul>
								{% else %}
									<p class="text-muted small mb-0">Aucun chapitre pour le moment.</p>
								{% endif %}
							</div>
						</div>
					</div>
				</div>
			{% endfor %}
		</div>
	{% else %}
		<div class="alert alert-info">No formations available yet.</div>
	{% endif %}
</div>
{% endblock %}
